# Чек-лист ручного тестирования редактора

Документ помогает быстро прогонять критичные сценарии после изменений редактора без автоматизации.

## Подготовка
- Очистите `localStorage` и `IndexedDB` домена (`localforage`), либо запустите в приватном окне.
- Откройте приложение с параметром `?edit=1` или `#/catalog?edit=1`, чтобы появилась кнопка «Редактировать».

## Сценарии

### 1. Создание и проверка PIN
1. Нажмите «Редактировать».
2. Введите PIN меньше 4 символов — должно появиться предупреждение, вход не выполняется.
3. Введите новый PIN от 4 символов — система запоминает хэш и включает режим редактирования.
4. Выключите режим (`Esc` или Ctrl+E) и включите снова — запросится PIN, старый ввод успешно авторизует.

### 2. История правок (Undo/Redo)
1. В активном режиме отредактируйте текст в блоке `.js-editable` — через ~0,5 секунды кнопка «Отменить» станет активной.
2. Нажмите «Отменить» — текст возвращается к предыдущему состоянию.
3. Нажмите «Повторить» — изменения вновь применяются.
4. Повторите шаги, чередуя текстовые правки и перетаскивания каталога — убедитесь, что история охватывает оба типа действий.

### 3. Перестановка каталога и сохранение
1. Перетащите категорию или товар за ручку `.js-drag`.
2. Обновите страницу — порядок сохраняется.
3. Очистите хранилище (`localforage` → `catalogOrder:v1`) и перезагрузите — порядок возвращается к исходному.

### 4. Экспорт и импорт
1. В режиме редактирования нажмите «Экспорт JSON» — сохраняется файл `site-snapshot-YYYYMMDD-HHMMSS.json`.
2. Измените несколько блоков и перетащите товары.
3. Выполните импорт сохранённого JSON — перед применением отображается подтверждение, состояние восстанавливается.
4. Повторите импорт с некорректным файлом — появляется сообщение об ошибке, состояние не меняется.

### 5. API-интеграции
1. После входа в режим убедитесь, что индикатор `/api/health` становится зелёным при доступности сервера.
2. Принудительно отключите сервер или используйте `Ctrl+Shift+R`, когда сервер остановлен — индикатор красный, генерация описаний сообщает о недоступности и предлагает повторить.

## Завершение
- По окончании тестов удалите временные данные (PIN, порядок каталога, бэкапы) в `localStorage`/`localForage`, если требуется чистый стенд.
